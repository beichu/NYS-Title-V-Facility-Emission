axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
top5_plot("CO")
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total, fill = "lightgray")) +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(title = analyte,
x = "Total Reported Emission (Tons)") +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
top5_plot("CO")
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total, fill = "gray80")) +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(title = analyte,
x = "Total Reported Emission (Tons)") +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
top5_plot("CO")
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total, fill = "grey80")) +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(title = analyte,
x = "Total Reported Emission (Tons)") +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
top5_plot("CO")
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey80") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(title = analyte,
x = "Total Reported Emission (Tons)") +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
top5_plot("CO")
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(title = analyte,
x = "Total Reported Emission (Tons)") +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
top5_plot("CO")
unqiue(emission_data_clean$Analyte)
unique(emission_data_clean$Analyte)
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
install.packages("cowplot")
# combine plots
plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"), ncol = 2)
library(cowplot)
# combine plots
plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"), ncol = 2)
# combine plots
plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"), ncol = 3)
NOx
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"), ncol = 3)
combined_plot
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = "Total Reported Emission (Tons)") +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO2 <- top5_plot("CO2")
PM10 <- top5_plot("PM10")
HAPS <- top5_plot("HAPS")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"), ncol = 3)
combined_plot
VOC
combined_plot
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"), ncol = 3)
combined_plot
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = "Total Reported {analyte} Emission (Tons)") +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
combined_plot
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = glue("Total Reported {analyte} Emission (Tons)")) +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
pollutants_by_SIC <- summary_stats %>%
ungroup() %>%
group_by(Analyte) %>%
arrange(Analyte, desc(Total)) %>%
select(Analyte, SIC_Desc, Total) %>%
mutate(idx = row_number()) %>%
mutate(idx = ifelse(idx <=5, idx, 6),
top5 = ifelse(idx <=5, SIC_Desc, "Other")) %>%
group_by(Analyte, idx, top5) %>%
summarise(Total = sum(Total))
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = glue::glue("Total Reported {analyte} Emission (Tons)")) +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(1.1),
face = "bold"))
}
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
combined_plot
PM2.5 <- top5_plot("PM2.5")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
combined_plot
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = glue::glue("Total Reported {analyte} Emission (Tons)")) +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(0.8),
face = "bold"))
}
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
combined_plot
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = glue::glue("Total Reported {analyte} Emission (Tons)")) +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(0.7),
face = "bold"))
}
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
combined_plot
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3) +
plot.background = element_rect(color = "black")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3) +
plot.background = element_rect(color = "black")
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = glue::glue("Total Reported {analyte} Emission (Tons)")) +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(0.7),
face = "bold"),
plot.background = element_rect(color = "black"))
}
VOC <- top5_plot("VOC")
VOC
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
combined_plot
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = glue::glue("Total Reported {analyte} Emission (Tons)")) +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(0.7),
face = "bold"),
plot.background = element_rect(color = "black"))
}
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
axis.title.y = element_blank(),
combined_plot
top5_plot <- function(analyte){
ggplot(pollutants_by_SIC %>% filter(Analyte == analyte)) +
geom_col(aes(y = reorder(top5, idx), x = Total), fill = "grey50") +
facet_wrap(~ reorder(top5, idx), ncol = 1, scales = "free_y") +
labs(x = glue::glue("Total Reported {analyte} Emission (Tons)")) +
scale_x_continuous(labels = comma,
expand = c(0, 0)) +
scale_y_discrete(guide = "none") +
theme_minimal() +
theme(panel.grid.minor = element_blank(),
panel.grid.major = element_blank(),
axis.line.x = element_line(color = "grey80", linewidth = .4),
axis.ticks.x = element_line(color = "grey80", linewidth = .4),
axis.title.y = element_blank(),
axis.title.x = element_blank(),
plot.margin = margin(10, 15, 10, 15),
strip.text = element_text(hjust = 0,
margin = margin(1, 0, 1, 0),
size = rel(0.7),
face = "bold"),
plot.background = element_rect(color = "black", size = 2))
}
VOC <- top5_plot("VOC")
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
VOC <- top5_plot("VOC")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
NOx <- top5_plot("NOx")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
CO <- top5_plot("CO")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
CO2 <- top5_plot("CO2")
Particulates <- top5_plot("Particulates")
PM10 <- top5_plot("PM10")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
PM10 <- top5_plot("PM10")
PM2.5 <- top5_plot("PM2.5")
HAPS <- top5_plot("HAPS")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
HAPS <- top5_plot("HAPS")
SO2 <- top5_plot("SO2")
# combine plots
combined_plot <- plot_grid(VOC, NOx, CO, CO2, Particulates, PM10, PM2.5, HAPS, SO2,
#labels = c("VOC", "NOx", "CO", "CO2", "Particulates", "PM10", "PM2.5", "HAPS", "SO2"),
ncol = 3)
combined_plot
# Convert to spatial object
facilities_sf <- st_as_sf(unique_name, coords = c("Longitude", "Latitude"), crs = 3857)
# Get NY basemap
state_boundaries <- counties(state = "NY") %>%
st_transform(crs = st_crs(3857)) # 3857 is the basemap crs
# Get NY basemap
state_boundaries <- counties(state = "NY") %>%
st_transform(crs = st_crs(3857)) # 3857 is the basemap crs
basemap_ggplot(state_boundaries, map_service = "osm", map_type = "streets") +
geom_sf(data = state_boundaries, fill = "transparent") +
geom_sf(data = facilities_sf, color = "gray30") +
labs(y = "Latitude",
x = "Longitude") +
ggtitle("Title V Facility Locations in New York State") +
theme(panel.background = element_rect(fill = "transparent", color = NA),
plot.background = element_rect(fill = "transparent", color = NA),
panel.grid = element_blank())
